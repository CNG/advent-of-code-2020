#!/usr/bin/env python
from collections import Counter
import doctest
import logging
import math
import sys

log = logging.getLogger(__name__).debug


def main():
    print("Part One")
    corner_ids = [int(t.name) for t in corners(parsed_tiles(data[0]))]
    assert 20899048083289 == math.prod(corner_ids)
    corner_ids = [int(t.name) for t in corners(parsed_tiles(data[1]))]
    # print(len(corner_ids))
    print(math.prod(corner_ids))

    print("Part Two")
    # I ran out of time tonight, so leave this part unfinished. Still a long way
    # to go and I'm not sure I'm even on the right track!
    tiles = parsed_tiles(data[0])
    the_corners = list(corners(tiles))

    a_corner = the_corners[0]
    the_rest = [t for t in tiles if t.name != a_corner.name]
    
    mt = MegaTile(int(len(tiles) ** 0.5))
    mt.set(0, a_corner)

    for i in range(1, len(tiles)):
        # try setting each then testing
        for tile in the_rest:
            mt.set(i, tile)
            if mt.test(i):
                print(f"tile {tile.name} belongs in {i}")
                break
    mt.print()
    return


    for tile in non_corners:
        if tile_a.name == tile_b.name:
            continue
        if match_any(tile_a, tile_b):
            print(f"{tile_a.name} matches {tile_b.name}")
            continue

    print(mt.validate())
    return


# Part One


def print_puzzle(tiles):
    tiles = list(tiles)
    rows = int(len(tiles) ** 0.5)
    for x in range(rows):
        for y in range(len(tiles[0].content)):
            if y == 0:
                for tile in tiles[x * rows : (x + 1) * rows]:
                    print(tile.name.ljust(len(tiles[0].content)), end=" ")
                print()
            for tile in tiles[x * rows : (x + 1) * rows]:
                print(tile.content[y], end=" ")
            print()
        print()


# def corners_product(ids):
#     r"""
#     >>> ids = [[1951, 2311, 3079], [2729, 1427, 2473], [2971, 1489, 1171]]
#     >>> corners_product(ids)
#     20899048083289
#     """
#     return ids[0][0] * ids[0][-1] * ids[-1][0] * ids[-1][-1]


def corners(tiles):
    log(f"We have {len(tiles)} tiles")

    def borders(tiles):
        return [border for tile in tiles for border in tile.borders]

    def all_borders(tiles):
        return [border for tile in tiles for border in tile.all_borders]

    def num_matching_borders(tiles, tile):
        return sum(
            1
            for border in tile.borders
            for t in tiles
            for b in t.all_borders
            if t.name != tile.name
            if b == border
        )

    for tile in tiles:
        log(f"Tile {tile.name}: {num_matching_borders(tiles, tile)}")
        if 2 == num_matching_borders(tiles, tile):
            yield tile

    # print_puzzle(tiles)


def parsed_tiles(data):
    return [Tile(tile) for tile in data.split("\n\n")]


class Tile:
    def __init__(self, data):
        name, content = data.split(":\n")
        self.name = name.strip("Tile ")
        self.content = [line for line in content.splitlines()]

        self.borders = []
        self.flipped_borders = []
        for _ in range(4):
            self.borders.append(self.content[0])
            self.rotate()
        self.flip()
        for _ in range(4):
            self.borders.append(self.content[0])
            self.rotate()
        self.flip()
        self.all_borders = self.borders + self.flipped_borders

    def flip(self):  # vertically
        self.content = self.content[::-1]
        self.borders, self.flipped_borders = self.flipped_borders, self.borders

    def rotate(self, count=1):  # clockwise
        for _ in range(count):
            self.content = list("".join(z) for z in zip(*self.content[::-1]))
            self.borders = [self.borders[-1]] + self.borders[:-1]
        return self.content

    def __str__(self):
        return "\n".join(self.content)


# Part Two


def match_any(tile_a, tile_b):
    for _flip in range(2):
        for _rotation in range(4):
            tile_a.rotate()
            for _flip_b in range(2):
                for _rotation_b in range(4):
                    tile_b.rotate()
                    if match_horiz(tile_a, tile_b):
                        return True
                tile_b.flip()
        tile_a.flip()
    return False


def match_horiz(*tiles):
    for a, b in zip(tiles, tiles[1:]):
        if a is None or b is None:
            continue
        if a.borders[1] != b.borders[3]:
            return False
    return True


def match_vert(*tiles):
    for a, b in zip(tiles, tiles[1:]):
        if a is None or b is None:
            continue
        if a.borders[2] != b.borders[0]:
            return False
    return True


def match_all(*tiles):
    rows = int(len(tiles) ** 0.5)
    for y in range(rows):
        if not match_horiz(tiles[y * rows : (y + 1) * rows]):
            return False
    for x in range(rows):
        if not match_vert(tile for i, tile in enumerate(tiles) if i % rows == x):
            return False
    return True


class MegaTile:
    def __init__(self, size=3):
        self.size = size
        self.tiles = [[None] * size] * size

    def validate(self):
        for row in self.tiles:
            if not match_horiz(row):
                return False
        for col in range(self.size):
            if not match_vert(row[col] for row in self.tiles):
                return False
        return True

    def set(self, pos, tile):
        col = pos % self.size
        row = (pos - col) // self.size
        self.tiles[row][col] = tile

    # def get(self, pos):
    #     col = pos % self.size
    #     row = (pos - col) // self.size
    #     return self.tiles[row][col]

    def test(self, pos):
        col = pos % self.size
        row = (pos - col) // self.size
        tile = self.tiles[row][col]
        mutations = 0
        while not self.validate() and mutations < 8:
            if mutations < 4: ## TODO?
                tile.rotate()
                mutations += 1
            elif mutations == 4:
                tile.rotate()
                tile.flip()
                mutations += 1
            else:
                tile.rotate()
                mutations += 1
        return self.validate()

    def print(self):
        print(repr(self.tiles))
        print_puzzle(t for row in self.tiles for t in row)


# Data

data = []
data.append(
    """Tile 2311:
..##.#..#.
##..#.....
#...##..#.
####.#...#
##.##.###.
##...#.###
.#.#.#..##
..#....#..
###...#.#.
..###..###

Tile 1951:
#.##...##.
#.####...#
.....#..##
#...######
.##.#....#
.###.#####
###.##.##.
.###....#.
..#.#..#.#
#...##.#..

Tile 1171:
####...##.
#..##.#..#
##.#..#.#.
.###.####.
..###.####
.##....##.
.#...####.
#.##.####.
####..#...
.....##...

Tile 1427:
###.##.#..
.#..#.##..
.#.##.#..#
#.#.#.##.#
....#...##
...##..##.
...#.#####
.#.####.#.
..#..###.#
..##.#..#.

Tile 1489:
##.#.#....
..##...#..
.##..##...
..#...#...
#####...#.
#..#.#.#.#
...#.#.#..
##.#...##.
..##.##.##
###.##.#..

Tile 2473:
#....####.
#..#.##...
#.##..#...
######.#.#
.#...#.#.#
.#########
.###.#..#.
########.#
##...##.#.
..###.#.#.

Tile 2971:
..#.#....#
#...###...
#.#.###...
##.##..#..
.#####..##
.#..####.#
#..#.#..#.
..####.###
..#.#.###.
...#.#.#.#

Tile 2729:
...#.#.#.#
####.#....
..#.#.....
....#..#.#
.##..##.#.
.#.####...
####.#.#..
##.####...
##..#.##..
#.##...##.

Tile 3079:
#.#.#####.
.#..######
..#.......
######....
####.#..#.
.#...#.##.
#.#####.##
..#.###...
..#.......
..#.###..."""
)
data.append(
    """Tile 2141:
#.#...#...
###..#...#
.....##...
..#.##..#.
.#....#..#
...#######
.....#...#
#.#......#
##........
########.#

Tile 3467:
..#.#....#
#.....#..#
....#....#
...#......
#.#....###
.#....#..#
#.........
.....#...#
.##...#...
##.#..#.#.

Tile 3389:
......##..
.##...#...
.#..###...
....##.#..
#..#.#....
.#.##..#..
#....##...
.#...#..##
..##.#...#
####..#..#

Tile 2797:
#..###..##
#.........
#.........
##.#....#.
.........#
.#...#...#
.........#
..#.#....#
..#...##..
...##..##.

Tile 1321:
.#....#..#
......#..#
#.#......#
#..#.#...#
.........#
.#..##....
...#.....#
#....#..#.
..##.##...
##.###.###

Tile 2741:
..#.#.####
#......##.
#.#...#.##
.##......#
..#.#....#
.#.#.....#
#........#
..#......#
#...#....#
...#..#..#

Tile 3169:
.##.#.#...
#.#..#...#
#...###...
..#...##..
.#..#.#.##
..#.......
...#......
.......#..
#.#.......
#.#.##..##

Tile 1097:
.##.#..#..
..#...##..
###.#.#...
..#..##...
......##.#
...#..#..#
#.#..#..##
.##.#...#.
##.#..#...
##..#...##

Tile 3457:
#.#.#.####
..#.#.#...
..#.......
##.....#..
#........#
.......#.#
#........#
#.......##
#..#.#..##
.##.##.#..

Tile 1471:
##.#.#.##.
..........
...#...#.#
#...#...#.
.....#..##
.......#.#
........##
...#...#.#
.#....####
.#.##.##.#

Tile 1531:
#....#..#.
#.#....#..
.......#..
.##.####.#
#..#.##..#
#........#
##.#.#...#
#...#....#
..........
...##..###

Tile 1523:
##..##.##.
...#..##..
#....#.#..
....#.####
#.#....#.#
....##..#.
#..#....#.
#..#..##.#
..#...##..
.#..####..

Tile 1447:
.#..#...##
.........#
..........
#.#....#.#
..#....##.
#......#.#
#.....#..#
#......#.#
..........
######....

Tile 2179:
#..#...#.#
..#......#
........#.
#.....#..#
......##..
#..#.##..#
#.##..#.#.
###.#..##.
...#..#..#
#.##..#.#.

Tile 1789:
#.#.#.##.#
#..#.#....
.#.#......
#.#....#..
##..#...#.
##..#....#
#.###.....
#..#.#.#..
#.......#.
#.##..####

Tile 2521:
.###..##..
..#.##....
##.#.....#
..##...#.#
#.###.#..#
.........#
.........#
#.........
.....#.#.#
.#....#.#.

Tile 3583:
..#..#.#..
..#.....##
#......#..
.........#
#...##.#.#
..#..#....
....#....#
#..#..#..#
#..#..###.
##...#.#.#

Tile 2633:
..#..#...#
..........
#..###..##
###......#
..#...#..#
#.###..###
##..#.##..
###.#.#..#
#....#....
#.#.######

Tile 1667:
###.##..#.
........#.
..#...##.#
........#.
#..##....#
#.#..#..##
.##......#
..#.......
#..#..#..#
.###..##.#

Tile 2003:
......#...
#.#.......
#..#......
#.....#..#
##.......#
.....##.##
#.###.....
#..#.#...#
......#...
#.##...#..

Tile 1103:
###.######
...######.
........#.
#....##..#
#.....#..#
#....#....
#..##..#.#
...##....#
#......#..
##...#.#.#

Tile 3167:
..##...##.
##.......#
...#...#.#
.......#..
.........#
........#.
##.......#
##.#.....#
..#.#.....
.#.####.##

Tile 1031:
#.##....##
#.#..#...#
#...#.....
#.#.......
#.#..##...
#...#....#
##..#....#
.#.#.....#
#.......##
...#####.#

Tile 2539:
##...#..##
..#....#..
......#..#
#...###..#
...#...#..
##....####
#.......##
#......#.#
.........#
.##.#..###

Tile 1871:
.#..#.#.##
...###...#
.........#
#...##....
...###...#
###.#..#.#
#..##....#
##.....#..
#....#..##
#####.##..

Tile 2383:
.#.....###
#.#.......
#.....#..#
.#...##..#
...#...#.#
#....#.#.#
...#....##
##.#..####
...#.....#
###.##.#..

Tile 1237:
##.#.#.##.
.##...####
#...#..#..
##.#..#.#.
##....#.#.
....#..###
....#....#
#.......##
..##...#.#
#.#..#..##

Tile 1093:
..##.###..
....###...
#..#.#....
#.........
..........
..#....#.#
#.....#...
........#.
......##.#
.#...#..##

Tile 1583:
..###.#..#
.........#
......##..
#....#..##
.###...###
..##..#.#.
....##.#.#
#.....#.#.
##.......#
#.#.##..#.

Tile 2243:
..#..#####
...#....##
#.....#..#
#......#.#
..#.#..#.#
.#...#...#
##.....#..
##.##.###.
#........#
#..#...#.#

Tile 1297:
..#......#
##..#.....
.##.#.....
.....##..#
.#....##..
#.#.#...##
.#........
.##.##.#.#
..#.###..#
#..#...#..

Tile 1877:
....###.#.
#....#....
.##...#..#
.........#
.........#
.#..##.#..
...#.....#
#.....#..#
...##.....
#.#.#.#...

Tile 3779:
.#...##..#
.#.......#
#.........
#.......##
.....#...#
.........#
...#.#...#
#.........
..#..#.###
#.#####.#.

Tile 2029:
....##..##
#..###...#
.....#..##
#...#.#...
##..###..#
#.#..##.#.
.......#.#
..##..#..#
..#....#.#
.##..#####

Tile 3221:
.#..#..##.
.###..#...
....#.##..
#.#.#.#.#.
#..#...#..
..........
#.#.....##
###....#.#
..###...#.
#......#..

Tile 3463:
.#.#......
#...#..#..
......#..#
#..#.##..#
#.....#..#
.#..###.#.
#####...#.
#.#....#..
#.........
##.###.#.#

Tile 3331:
##.###..##
##..#..#..
.....##...
..#...#.#.
#..#.#...#
...###....
.........#
.###....##
#...####.#
..#.##....

Tile 2473:
..####.#.#
##.#....##
......#.##
##.......#
##...##..#
##....#..#
.#.#.#....
......##.#
..#.##....
#..###...#

Tile 2459:
##.##....#
..........
#.#....###
#.........
##....##.#
...#......
###.......
..........
#.....#...
.#.###.#.#

Tile 3877:
...#.#.#..
#....#...#
.#......#.
......##.#
....#.##.#
.#.#..#.##
##........
....#.####
###...#.##
######..##

Tile 2161:
..##...#..
#....#...#
#.#.#.#..#
.##....###
...#..#...
#.........
.##....##.
.........#
#........#
.#.#.###..

Tile 3361:
#..##.....
.##.....#.
#........#
#..#......
#.........
##...##..#
..#..#....
#.#.......
...#.....#
###.#.##..

Tile 2089:
.##.####.#
...#....##
.###.#.#..
.........#
..#.##..#.
.###..##..
..........
...##.#..#
#..#....##
#...####.#

Tile 2711:
.##.#..###
#.#.....##
#..###.#.#
.##.....##
...#....#.
##......#.
#........#
..#.......
###..#.#.#
...#.##..#

Tile 1753:
....##.###
#........#
#...#...#.
..##.#....
#..#..#.##
#.....#..#
#.........
...#......
##.....#..
##..#.....

Tile 2953:
.#.####..#
...#.....#
.##.....##
#...#.....
##........
###.#..#.#
#..#.##...
#..#...#..
#.#......#
..#.#...#.

Tile 3593:
#..#.#..#.
#.#.....#.
#.#.......
#..#.....#
...#..#...
#........#
#....#.#.#
#..#......
..#......#
...#..#.##

Tile 1483:
..#.####..
.#.......#
##........
.......#..
##..#....#
#........#
..#...#...
#.........
###....#..
..#.#..##.

Tile 1657:
#####..##.
.###....#.
...#...#.#
#..#....#.
#.#...#.#.
.....##.##
.......#.#
####......
#..##....#
..#...#..#

Tile 3307:
.#..##.###
....#..#..
###..#..##
#.###.....
..###....#
#..#...#.#
.........#
....#.###.
..#......#
#.##.#.###

Tile 3617:
...#.#.#..
..........
.#....#.##
.#.#...#..
.#.....#..
.##.#..###
#..#......
#......#..
.#..#...#.
#.##..#..#

Tile 3001:
##...#####
..##.....#
#.....#.##
##........
....#.....
#....#..#.
...##.#...
.......#.#
#.....#..#
#.####....

Tile 1013:
.##..#....
#....##...
#...#...##
.#.###...#
....#..#..
##...#..#.
..#....#..
#...#..#.#
...#.....#
####.#####

Tile 2801:
#...##.##.
#.....#...
......#...
#....#...#
...##.....
.#......#.
....##..##
#....#####
....##...#
..#..###..

Tile 3079:
..##.#...#
#.....#...
...#.....#
..#..#...#
#..#...###
#.##......
#.###.....
#........#
#.....#.#.
..#.#...#.

Tile 1231:
####.#####
..#.#....#
.#....#...
.#..#....#
..#......#
#..#.###.#
.#.......#
#.##...#.#
.....#.###
.###.###.#

Tile 1171:
..#..#..##
#...#....#
#....#...#
#.........
###......#
#...#..#..
..#..#.#..
...#...#..
.....#....
###..#.###

Tile 3319:
###.#####.
..........
..##......
#.......#.
#..#.#..#.
.#.##.....
..###..#.#
#...#...##
##.#.#....
...##...##

Tile 2129:
##...#.###
#........#
.....#...#
##.......#
#.#.#.#...
......#...
#....#..#.
..........
.......#.#
.###.###.#

Tile 3371:
.##.......
#....#.#.#
..#.#...##
#.........
.#.....#..
#.....#.##
...#......
##....#...
..#..##..#
#..#.#####

Tile 1129:
#.##..#.#.
#......###
#.#....#..
.####...##
#...#..#.#
#..#......
.##.....##
#..#.....#
..........
#.###..#..

Tile 1399:
#.....#.##
#........#
.....##...
........##
...#...#..
#.###..##.
#..#.#.#.#
....##.#.#
#.##.....#
.#..###.##

Tile 2503:
#...#...##
#..#.#....
.....#.#.#
...#.....#
..#......#
..##.....#
.....#....
...#...#.#
.#........
#.###...#.

Tile 3529:
.##...####
.#.....###
#..#..##..
....##.#.#
.......##.
#........#
.........#
#.##......
##....#..#
....#.##.#

Tile 1181:
.#.##.#.##
#..#......
#........#
..##......
##.#...#.#
.#.##..#.#
##........
#..#..#..#
#.#...#..#
..#.#.##..

Tile 1759:
...#..#..#
..#...#...
##....#...
#.#..#.#..
#.......##
#...#...##
##......#.
##...#.###
##...#....
.##...#...

Tile 2543:
######.###
####....##
##.#..#.#.
##...#....
..........
..#......#
#.......##
##........
..###..##.
##....####

Tile 3613:
.##..#....
......#..#
#.........
....##...#
....#....#
.#..#.....
....##...#
#.#..#..#.
#..#.....#
##.##...##

Tile 3853:
....######
.####....#
..###.....
#.#.......
#..#..#...
....#...##
##....##.#
#..##..#..
#.#..#...#
..#######.

Tile 3187:
.#..#.####
#.##....#.
.....#....
##....#...
.#.##.#...
#...##...#
#....#...#
......#...
#....#..#.
#..###....

Tile 2437:
#..#.##.#.
##...###.#
.....#....
.#......#.
...##.#...
#..###...#
#....#....
.#....#..#
..........
.##.#.#..#

Tile 2917:
#.....#...
.#.#...#..
#.##.##..#
......#..#
...###....
##.#......
....#....#
###.....##
.#.#....##
####.#..##

Tile 1511:
#...###.#.
..##.#..##
..#...#...
##.#..#.##
##....#..#
#.........
#........#
........#.
#.....##.#
.#.....##.

Tile 2699:
.#.#......
#........#
..##...#..
......##..
..##..#..#
#.###..#.#
#.#..#...#
#.##.....#
..###.....
###..##.##

Tile 3259:
###.###..#
.........#
#.#.....#.
...#..#...
.##....###
##.......#
...#.#...#
...##...##
#.........
......#...

Tile 1429:
....##.##.
.###...#..
##.#...###
#.........
#....#...#
#.....#...
...#.##...
#.......##
.#......##
###.#.##..

Tile 2039:
#....###.#
.#..#.#..#
#.#.#...#.
..#.......
##...#..##
#.#.......
#......##.
..#....#.#
#.#.......
..####.#..

Tile 3637:
#.###.#.##
#......###
#.........
.....#...#
..#..#.##.
#..#....#.
........#.
..#.......
...#......
...#.###.#

Tile 1163:
##.###.##.
#.##.#....
..#.#.....
#..####.#.
#..#......
#......#.#
.#........
.#.##.....
#.##....##
##.#......

Tile 3761:
...##.###.
.........#
....#.....
##.......#
#.......#.
...##.....
#.#.......
.........#
#.#......#
.##.###...

Tile 1777:
##...##.##
....#.....
.#...#....
#....#.#.#
..#.#....#
#....###.#
##...#....
#...###..#
#...##..#.
......#.##

Tile 2857:
.#..#.##..
#..#.....#
##........
...#.#..#.
.##..#..#.
#####.##.#
#..##.....
##...#.#.#
#...#.....
...##.##.#

Tile 3061:
.#.#.###.#
#........#
.###.###..
..##.....#
#...#....#
#.#.#..###
.##......#
.....##...
....#.....
.#..#..#..

Tile 1721:
..#..#####
.#....###.
#..#...#..
#.........
#....#...#
...##..##.
#........#
#......#..
#.........
....##.###

Tile 2693:
.....#.#..
.#......#.
.#.....#.#
#....##..#
#..#......
####.##..#
#.#.....#.
..........
#.#....#.#
#.##..#...

Tile 1259:
#...#..###
#...#...##
##..#.#..#
#.#.......
#......#.#
###.......
#...#.....
...#.....#
.#...#...#
.#...##.##

Tile 1291:
#..##.#...
#.....##.#
.#..#....#
#...#...#.
..###.#...
###......#
#..#...#.#
#....#....
..##......
#..#..#.#.

Tile 1051:
#...####.#
##..#.....
.........#
.#..#..#..
##...#..##
...##....#
##........
.#......#.
...#.....#
###.###..#

Tile 2719:
.#.##..##.
.#.....#..
#.....#...
##.#.....#
#######...
##...##.#.
......##..
........##
..#....###
#..#..#.##

Tile 3533:
...##....#
##.......#
#....#....
....##...#
.....##.##
....#..##.
#.........
###...#.#.
#.........
#..####...

Tile 2659:
.##.#...#.
.#..#...#.
....#...##
.#..#.#..#
#.##.##..#
..##.....#
..#..#..##
..#.......
.........#
#....####.

Tile 3517:
#..##.#.#.
.#...#...#
.#.#.....#
##.......#
..#.......
#......#..
.........#
...##...#.
......#.##
..##...#..

Tile 2371:
###.##.##.
.#.#.##..#
.....#...#
#.#.#..#.#
####...#.#
#.#.#.##..
..#.#.....
##........
..#..#...#
#...#.###.

Tile 1601:
.####..##.
#.........
......#...
#.#..##.#.
..##.#.#.#
#.......#.
#..#.....#
#.....#.#.
..###....#
.#..######

Tile 2273:
..###.###.
....#.....
.##...#...
#.#...#...
....#.....
.#.....#.#
.#......#.
.#.#..#...
........##
##..###...

Tile 3917:
####.#...#
#...#...##
#.##...###
#..#...##.
....#....#
.........#
......#..#
###.#.#...
...##...##
#..#####.#

Tile 3701:
#..###...#
###..#...#
#.#...##.#
.##.#.#..#
.##..#..##
##..#.#...
.##.#.#.##
....##.#..
#.....#...
..##.##.#.

Tile 2081:
...####.#.
........##
#.#...#..#
.###...##.
#..#.##...
#....#....
#.#..###..
........##
..#......#
...##..###

Tile 2339:
#.#..#..##
.#..#...#.
........##
.##....#..
#.....#.#.
........#.
....#...##
.#....##..
#........#
#.##.#...#

Tile 1373:
###.###...
.........#
#......###
#...##...#
.###....#.
#..#.....#
..........
##..#..#.#
.###.#..##
###...##..

Tile 2837:
##....#...
...#...#.#
#.........
..#.......
##.#......
.#....#...
.###....#.
##......##
.....#....
.#.##.....

Tile 3803:
#..#..##..
.......#..
##.###....
#.#.#.#...
....##....
#.###..#.#
....#...##
........#.
..##.....#
..#..###..

Tile 3559:
#....##.##
...##.....
..#..#...#
#........#
##........
#.#.......
#.#..#.#.#
#....#..#.
#...#.....
##.#.#....

Tile 1549:
####.##.#.
......#...
#..#.#..##
#..#..#.#.
.#.....#.#
.........#
.........#
#....#...#
#.......#.
#####....#

Tile 1699:
.#.##.#.#.
.#..####..
.#.#......
.###..##.#
#........#
##.#......
.#.#.##..#
#.#..#....
#.......#.
.###.##..#

Tile 2647:
###.......
.......#.#
..#.#...#.
#..#...#..
..##......
#.#.#....#
....#.#.#.
#.........
#...#.....
#.###...##

Tile 1361:
...##.#.#.
..........
#.........
#.#....#..
##..##...#
....#.....
#.......#.
..........
#.##.#.#..
#..##.#.##

Tile 3851:
##........
...##.#...
....#.....
....####..
#.....#..#
#...#.##.#
#..#.....#
...#..##.#
#.#....#..
#..####...

Tile 3911:
##..##.##.
#.#.....##
...#.#...#
.....#....
.#...#..#.
...##.##..
#.#.#.####
.......#.#
...#.#....
##..#.##.#

Tile 3719:
##.##.###.
....#..#..
...#......
#......###
.#.#....##
..###...#.
....#..#.#
..........
#..#....#.
#####..###

Tile 2239:
###.##.##.
###......#
#.##.#..#.
..#....#..
......##..
.....#..#.
...#......
#.........
..........
.#.....###

Tile 1249:
#.#..####.
...#.....#
....#....#
.........#
.#.##...##
..#.####.#
...###....
#.........
#.....#...
.#..#.#...

Tile 2707:
.##.#.....
#.....##.#
.#..#...##
...#.#.#..
..#.......
.#.#...#..
#.....#...
#.##......
.#........
.###.#..##

Tile 2897:
..###...#.
...#..#..#
#......#..
#..#.....#
.....#....
..##..####
#...##...#
#.#......#
##......##
......#..#

Tile 3623:
#..#.....#
##.#...##.
##.......#
#.#....#.#
.#....#..#
#.##..#...
.##....#.#
.#.......#
#.#.#..#.#
#..#.###.#

Tile 2617:
.######...
#..#.....#
..........
#####....#
....#....#
##.###..##
......##..
.....##..#
#.........
...####.#.

Tile 1049:
..#.##...#
.#.....#.#
......#..#
#####.#...
......#...
....#.....
#.........
#.........
##.......#
..#..#.#.#

Tile 3019:
##.##..#..
##...#..##
...#....#.
..........
...#......
#...#...#.
####.##.#.
###......#
.....#....
######...#

Tile 3067:
#...#.#..#
#.#.##...#
....#.#..#
##.#......
....###..#
.#.....#..
.#.......#
......#..#
##.#.....#
.#####.###

Tile 3203:
#...###.##
#.#......#
..#..#..#.
.##...##.#
#.....###.
...##....#
#......#.#
.#........
.#.#....##
##.#####.#

Tile 2113:
.#.#.#..#.
#...#.....
###.....##
#.###.....
##........
#...##....
......####
......#..#
#..###.##.
..#.###.##

Tile 2591:
##..###...
........##
#........#
.....##..#
.........#
..#...#...
....#..#.#
#......#..
...#......
.##.##.#.#

Tile 1499:
.....##..#
...#......
.##.....#.
......##.#
.#........
#..##.#...
....##...#
#........#
....#.....
.#.##.#..#

Tile 3413:
#..#..##..
.#..#..###
#..#....##
##.......#
#.###.....
#....#..##
#........#
.....#...#
#...#....#
#.#..#..#.

Tile 3923:
.#...#####
#..####...
#.##....#.
#....##..#
#.#...##.#
..#..#....
#.#......#
.#..#..#.#
#.##....#.
###.###...

Tile 3527:
#.##...###
#......##.
#..#..#..#
....#....#
#.....#.##
..........
#........#
#..#.#...#
.##..#...#
#.#.##.###

Tile 2957:
###.#...#.
#.#..#....
...#.....#
#.#......#
.##.....#.
.........#
....#.....
#......#.#
...#......
#..##.##..

Tile 1481:
##....#...
...#...#.#
#.##......
.......#..
.#..#..#.#
.....###.#
#.........
.......##.
......#...
..###....#

Tile 1747:
###..#####
..#.##....
##.......#
.#........
#.##.....#
...#......
#........#
#.##...#.#
####......
##.##...#.

Tile 3659:
.##.###...
##..##.##.
####..#.##
....##.###
#.........
.##.#.#..#
.#...#..##
..####.##.
#..#..#...
..###...#.

Tile 2621:
#####....#
...#....#.
.##......#
..###....#
...#..#...
.........#
#.........
.#..#..#..
.#...##...
#......#.#

Tile 2927:
.#..####..
......#.##
.......#.#
#...#.##.#
##...#..##
#.....##.#
#.......#.
##........
#.....#...
##.#.##...

Tile 3727:
..#.....#.
#........#
####..#..#
##.#....##
...#......
###....#..
#..##..#.#
#.#.#...##
#...#.....
.####.##.#

Tile 2803:
##.##..###
#....###.#
#.....##..
#.#...#...
.#.#......
#...##..##
......#...
##.....#.#
.##.#..##.
..##.##...

Tile 2593:
.##.#....#
#.#.#.#...
#.......##
..........
...####...
....##....
#...##.#.#
#...##..##
.##......#
##....##.#

Tile 3109:
.###.#..##
#.........
.#...#..##
##...#...#
#..#....#.
#.........
#........#
#.##..#...
.#.......#
#.#####..#

Tile 3797:
#...##.##.
.....#..#.
##..##.#..
#........#
.#...#....
##..#.#...
##....#...
###.##...#
#......#.#
##.###..#.

Tile 1367:
##.#..##.#
..#.......
.#.......#
...#..##..
.##....##.
#..#.##..#
..#...#..#
#.#......#
#..#....##
...##..#..

Tile 2309:
##.#.####.
..###.....
...#....##
..#....#..
.#....#..#
##....#..#
..#......#
..##..##.#
.....###.#
#..##.##.#

Tile 2087:
.#.#.#.#.#
#.##....#.
#..#....#.
...#......
#.......##
...#..#...
#...###..#
.#....#..#
.#.###...#
.#.#######

Tile 2441:
....####.#
.........#
#.....##..
.#..##.#.#
####.#..##
#.#.....#.
#.#.#.##.#
....#...##
###..###.#
.#.....##.

Tile 3643:
##.#...###
..##....##
.....#....
#.#.#.#...
...#.#.#..
....##....
....##....
#.....##.#
#.......##
.......##.

Tile 3251:
##...#.#..
.#.......#
.#....##..
..#.....##
.#.#......
..#..##.##
.##..###.#
....#....#
##..##...#
#.#..###.#

Tile 1787:
#.#.#..#.#
..........
..#......#
..........
.#......#.
..#....#..
........#.
##....#..#
..##......
###.#...#."""
)


if __name__ == "__main__":
    doctest.testmod(verbose=False)
    if len(sys.argv) > 1 and sys.argv[1] in ("-v", "--verbose"):
        logging.basicConfig(level=logging.DEBUG)
    main()
